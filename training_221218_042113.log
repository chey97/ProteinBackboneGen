INFO:root:Clean dataset class: <class 'foldingdiff.datasets.CathCanonicalAnglesOnlyDataset'>
INFO:root:Creating data splits: ['train', 'validation', 'test']
INFO:root:Loading cached full dataset from /home/kihara/cgalkadu/foldingdiff/foldingdiff/cache_canonical_structures_cath_1594d9a300ac8d620483f058415b74c7.pkl
INFO:root:Hash matches between codebase and cached values!
INFO:root:Removing structures shorter than 40 residues excludes 536/30931 --> 30395 sequences
INFO:root:Split train contains 24316 structures
INFO:root:Offsetting features ['phi', 'psi', 'omega', 'tau', 'CA:C:1N', 'C:1N:1CA'] by means [ 1.3270776  1.4532967  1.5187805 -1.4707634  0.0372179  3.127618
  1.9405223  2.0353627  2.122601 ]
INFO:root:Length of angles: 40-1202, mean 153.1534380654713
INFO:root:CATH canonical angles only dataset with ['phi', 'psi', 'omega', 'tau', 'CA:C:1N', 'C:1N:1CA'] (subset idx [3, 4, 5, 6, 7, 8])
INFO:root:Loading cached full dataset from /home/kihara/cgalkadu/foldingdiff/foldingdiff/cache_canonical_structures_cath_1594d9a300ac8d620483f058415b74c7.pkl
INFO:root:Hash matches between codebase and cached values!
INFO:root:Removing structures shorter than 40 residues excludes 536/30931 --> 30395 sequences
INFO:root:Split validation contains 3039 structures
INFO:root:Offsetting features ['phi', 'psi', 'omega', 'tau', 'CA:C:1N', 'C:1N:1CA'] by means [ 1.3272761   1.453351    1.5188463  -1.4752941   0.07301617  3.1281178
  1.9403243   2.0353866   2.1226134 ]
INFO:root:Length of angles: 40-869, mean 154.55248436985852
INFO:root:CATH canonical angles only dataset with ['phi', 'psi', 'omega', 'tau', 'CA:C:1N', 'C:1N:1CA'] (subset idx [3, 4, 5, 6, 7, 8])
INFO:root:Loading cached full dataset from /home/kihara/cgalkadu/foldingdiff/foldingdiff/cache_canonical_structures_cath_1594d9a300ac8d620483f058415b74c7.pkl
INFO:root:Hash matches between codebase and cached values!
INFO:root:Removing structures shorter than 40 residues excludes 536/30931 --> 30395 sequences
INFO:root:Split test contains 3040 structures
INFO:root:Offsetting features ['phi', 'psi', 'omega', 'tau', 'CA:C:1N', 'C:1N:1CA'] by means [ 1.3273247   1.4533684   1.5188134  -1.4690427   0.03956273  3.127477
  1.940246    2.0355554   2.1222587 ]
INFO:root:Length of angles: 40-873, mean 153.78815789473686
INFO:root:CATH canonical angles only dataset with ['phi', 'psi', 'omega', 'tau', 'CA:C:1N', 'C:1N:1CA'] (subset idx [3, 4, 5, 6, 7, 8])
INFO:root:Updating valid/test mean offset to [ 1.3270776  1.4532967  1.5187805 -1.4707634  0.0372179  3.127618
  1.9405223  2.0353627  2.122601 ]
INFO:root:Using <class 'foldingdiff.datasets.NoisedAnglesDataset'> for noise
INFO:root:Getting cosine variance schedule with 1000 timesteps
INFO:root:Getting cosine variance schedule with 1000 timesteps
INFO:root:Getting cosine variance schedule with 1000 timesteps
INFO:root:train: NoisedAnglesDataset wrapping <foldingdiff.datasets.CathCanonicalAnglesOnlyDataset object at 0x7f78e236a4f0> with 24316 examples with cosine-1000 with variance scales 1.0 and 1.0
INFO:root:validation: NoisedAnglesDataset wrapping <foldingdiff.datasets.CathCanonicalAnglesOnlyDataset object at 0x7f78e30ed970> with 3039 examples with cosine-1000 with variance scales 1.0 and 1.0
INFO:root:test: NoisedAnglesDataset wrapping <foldingdiff.datasets.CathCanonicalAnglesOnlyDataset object at 0x7f78e34a8310> with 3040 examples with cosine-1000 with variance scales 1.0 and 1.0
INFO:root:Using loss function: smooth_l1
INFO:root:Auto detected 6 inputs
INFO:torch.distributed.nn.jit.instantiator:Created a temporary directory at /tmp/tmpti2bh8kq
INFO:torch.distributed.nn.jit.instantiator:Writing /tmp/tmpti2bh8kq/_remote_module_non_scriptable.py
INFO:root:Mapping loss smooth_l1 to list of losses corresponding to angular [True, True, True, True, True, True]
INFO:root:Model callbacks: [<pytorch_lightning.callbacks.model_checkpoint.ModelCheckpoint object at 0x7f78dbb0da00>, <pytorch_lightning.callbacks.model_checkpoint.ModelCheckpoint object at 0x7f78e2358df0>, <pytorch_lightning.callbacks.lr_monitor.LearningRateMonitor object at 0x7f78e236ad90>]
INFO:root:Using cuda with strategy <pytorch_lightning.strategies.ddp.DDPStrategy object at 0x7f78dbb044c0>
INFO:torch.distributed.distributed_c10d:Added key: store_based_barrier_key:1 to store for rank: 1
INFO:torch.distributed.distributed_c10d:Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
INFO:torch.nn.parallel.distributed:Reducer buckets have been rebuilt in this iteration.
